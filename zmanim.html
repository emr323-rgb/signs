<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>זמנים - בית הכנסת לייקווד</title>
    <style>
        /* (Keep your full existing <style> block here – same as before) */
        /* Paste the style from your last working version */
    </style>
</head>
<body>

    <!-- (Keep your full existing body HTML structure – header, grid, sections, IDs) -->
    <!-- Paste the body from your last version -->

    <script>
        // MyZmanim API settings
        const API_KEY = '84318fa94defdf4b3ee66cd222a3c256f0d486ec7d4abbd2cf23013e423bd616b32ea38d9b4ca1e8';  // ← Replace with your actual key
        const API_USER = '0010457947';  // ← Replace with your user (from MyZmanim account)
        const LOCATION_ID = 'US33487';  // Lakewood NJ location ID (standard for MyZmanim)

        // Today's date in YYYY-MM-DD
        const today = new Date().toISOString().split('T')[0];

        // Build the API URL
        const url = `https://api.myzmanim.com/engine1.json.aspx?coding=JS&language=en&locationid=${LOCATION_ID}&inputdate=${today}&key=${API_KEY}&user=${API_USER}`;

        fetch(url)
            .then(response => {
                if (!response.ok) throw new Error('API error');
                return response.json();
            })
            .then(data => {
                const zman = data.Zman || {};
                const time = data.Time || {};

                // Hebrew date
                document.getElementById('current-date').textContent = time.WeekdayHebrew || new Date().toLocaleDateString('he-IL');

                // Format time helper
                function format(t) {
                    if (!t) return 'לא זמין';
                    return t;  // MyZmanim returns formatted HH:MM AM/PM
                }

                // Fill zmanim (using MyZmanim keys)
                document.getElementById('netz').textContent = format(zman.SunriseDefault);
                document.getElementById('shema-gra').textContent = format(zman.ShemaGra);
                document.getElementById('shema-mga').textContent = format(zman.ShemaMGA);
                document.getElementById('chatzot').textContent = format(zman.Chatzot);
                document.getElementById('mincha-gedola').textContent = format(zman.MinchaGedola);
                document.getElementById('plag').textContent = format(zman.PlagHamincha);
                document.getElementById('sunset').textContent = format(zman.SunsetDefault);
                document.getElementById('tzeit').textContent = format(zman.Tzais72min);  // Or TzaisDefault if preferred

                // Variable davening (edit offsets)
                const plagTime = zman.PlagHamincha;
                if (plagTime) {
                    const [time, period] = plagTime.split(' ');
                    let [h, m] = time.split(':');
                    let date = new Date();
                    date.setHours(period === 'PM' && h !== '12' ? parseInt(h) + 12 : h);
                    date.setMinutes(parseInt(m) - 15);
                    document.getElementById('mincha-time').textContent = date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                }

                const sunsetTime = zman.SunsetDefault;
                if (sunsetTime) {
                    const [time, period] = sunsetTime.split(' ');
                    let [h, m] = time.split(':');
                    let date = new Date();
                    date.setHours(period === 'PM' && h !== '12' ? parseInt(h) + 12 : h);
                    date.setMinutes(parseInt(m) + 20);
                    document.getElementById('maariv-time').textContent = date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                }

                // Variable shiur
                if (sunsetTime) {
                    const [time, period] = sunsetTime.split(' ');
                    let [h, m] = time.split(':');
                    let date = new Date();
                    date.setHours(period === 'PM' && h !== '12' ? parseInt(h) + 12 : h);
                    date.setMinutes(parseInt(m) + 50);  // Adjust offset
                    document.getElementById('halacha-time').textContent = date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('current-date').textContent = 'שגיאה בטעינה';
            });
    </script>
</body>
</html>
